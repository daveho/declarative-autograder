<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: X
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "X";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (X)</a> &raquo;
    
    
    <span class="title">X</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: X
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">X</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>autograder2.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Public front-end namespace for the autograder framework.</p>

<p>The name “X” has no significance. It was chosen to be as concise as possible, in order to make <code>run_autograder</code> scripts as noise-free as possible.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="X/Pred.html" title="X::Pred (class)">Pred</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_visibility_of-class_method" title="_visibility_of (class method)">.<strong>_visibility_of</strong>(testname)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Private method to check a testname to determine whether it specifies a hidden or visible test.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all-class_method" title="all (class method)">.<strong>all</strong>(*tasks, report_failure: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a task which executes all tasks in sequence, auto-failing any tasks that follow a failed task.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check-class_method" title="check (class method)">.<strong>check</strong>(*filenames, check_exe: false, subdir: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a task which will check to see if files in the <code>submission</code> directory exist.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_exe-class_method" title="check_exe (class method)">.<strong>check_exe</strong>(*filenames, subdir: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check to see if files in the submission directory exist and are executable.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#checkExe-class_method" title="checkExe (class method)">.<strong>checkExe</strong>(*filenames, subdir: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use <span class='object_link'><a href="#check_exe-class_method" title="X.check_exe (method)">X.check_exe</a></span> instead</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#combine-class_method" title="combine (class method)">.<strong>combine</strong>(*args)  &#x21d2; Array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Build an array consisting of all arguments as elements, with the exception that arguments that are arrays will have their elements added.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copy-class_method" title="copy (class method)">.<strong>copy</strong>(*files, subdir: nil, report_command: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Copy one or more files from the <code>files</code> directory into the <code>submission</code> directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copydir-class_method" title="copydir (class method)">.<strong>copydir</strong>(*dirnames, report_command: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Recursively copy one or more entire directories from the <code>files</code> directory into the <code>submission</code> directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eval_pred-class_method" title="eval_pred (class method)">.<strong>eval_pred</strong>(pred, report_desc: true, report_outcome: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A task that evaluates a predicate and produces an outcome based on the result (true or false) of that predicate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute_tests-class_method" title="execute_tests (class method)">.<strong>execute_tests</strong>(rubric, plan)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Execute the tests and return a hash that can be converted into a results JSON file, using the correct schema for a Gradescope <code>results.json</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expectfail-class_method" title="expectfail (class method)">.<strong>expectfail</strong>(task)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a task which execute one specified task and expects it to fail.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#glob-class_method" title="glob (class method)">.<strong>glob</strong>(pattern)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return list of files matching specified “file glob” pattern in <code>files</code> directory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inorder-class_method" title="inorder (class method)">.<strong>inorder</strong>(*tasks)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a task which executes a sequence of tasks and records their outcomes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make-class_method" title="make (class method)">.<strong>make</strong>(*makeargs, subdir: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create and return a task to run <code>make</code> in the <code>submission</code> directory (or a specified subdirectory).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nofail-class_method" title="nofail (class method)">.<strong>nofail</strong>(*tasks)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a task which executes all tasks in sequence and pushes their outcomes, but changes all of the outcomes to true, creating the illusion that all tests succeed even if they didn&#39;t.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#post_results-class_method" title="post_results (class method)">.<strong>post_results</strong>(results_json)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Write generated JSON results object to correct location to report autograder results to Gradescope.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pred-class_method" title="pred (class method)">.<strong>pred</strong>(pred_func, desc)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a predicate from a lambda and a string with a textual description of the predicate being evaluated.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result_obj-class_method" title="result_obj (class method)">.<strong>result_obj</strong>(testname, desc, maxscore, outcome_pair)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Internal method to create a result object for an executed test.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result_obj_for_missing_test-class_method" title="result_obj_for_missing_test (class method)">.<strong>result_obj_for_missing_test</strong>(testname, desc, maxscore)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Internal method to return a result object for a testname that is missing from the results map.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-class_method" title="run (class method)">.<strong>run</strong>(*cmd, timeout: DEFAULT_TIMEOUT, timeout_signal: nil, report_command: true, report_stdout: false, report_stderr: false, report_outcome: true, stdin_filename: nil, stdout_filename: nil, subdir: nil, env: {}, success_pred: DEFAULT_SUCCESS_PRED, rlimit_hash: {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create and return a task to run a command (program or script) in the <code>submission</code> directory (or a specified subdirectory).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test-class_method" title="test (class method)">.<strong>test</strong>(testname, task, judge: DEFAULT_JUDGE)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a task which executes a test by invoking the specified task and determining whether its outcome was successful, unsuccessful, or partially successful.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_passed-class_method" title="test_passed (class method)">.<strong>test_passed</strong>(testname, results)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check whether a test passed.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="_visibility_of-class_method">
  
    .<strong>_visibility_of</strong>(testname)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Private method to check a testname to determine whether it specifies a hidden or visible test.  Hidden tests are specified by testnames ending with <code>_hidden</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>testname</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the testname to check</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>true if the testname indicates a hidden test, false if it indicates a visible test</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 666</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid__visibility_of'>_visibility_of</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_testname'>testname</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_end_with?'>end_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_hidden</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hidden</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>visible</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all-class_method">
  
    .<strong>all</strong>(*tasks, report_failure: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a task which executes all tasks in sequence, auto-failing any tasks that follow a failed task. This is useful for ensuring that prerequisite tasks execute successfully before dependent tasks run.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># make the_program, and if successful, base the outcome of the
</span><span class='comment'># :program_runs test on whether or not it runs successfully
</span><span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_make'><span class='object_link'><a href="#make-class_method" title="X.make (method)">make</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>the_program</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_test'><span class='object_link'><a href="#test-class_method" title="X.test (method)">test</a></span></span><span class='lparen'>(</span><span class='symbol'>:program_runs</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_run'><span class='object_link'><a href="#run-class_method" title="X.run (method)">run</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./the_program</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
</code></pre>

<p>In the example above, if the <code>X.make</code> task fails (e.g., because of a compilation error), then the <code>X.test</code> task is automatically considered to have failed.</p>

<p>When the failure of a task causes subsequent tasks to fail, a message of the form “Task failed, not executing subsequent tasks” will be logged, unless the <code>report_failure</code> parameter is specified as false.</p>

<p>A single outcome is pushed: true if all tasks succeeded, false if any tasks failed.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tasks</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the sequence of tasks</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_failure</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if true, report if a task failure will suppress further tasks (defaults to true)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 575</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasks'>tasks</span><span class='comma'>,</span> <span class='label'>report_failure:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_task_outcomes'>task_outcomes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_any_failed'>any_failed</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='comment'># Execute the individual tasks
</span>    <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_tasks'>tasks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
      <span class='id identifier rubyid_is_last'>is_last</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span> <span class='op'>==</span> <span class='id identifier rubyid_tasks'>tasks</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_any_failed'>any_failed</span>
        <span class='comment'># This task gets auto-failed
</span>        <span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
        <span class='comment'>#logger.log(&quot;Auto-failing task, yo&quot;)
</span>      <span class='kw'>else</span>
        <span class='id identifier rubyid_num_outcomes'>num_outcomes</span> <span class='op'>=</span> <span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
        <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: task failed to generate an outcome</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_num_outcomes'>num_outcomes</span> <span class='op'>+</span> <span class='int'>1</span>
        <span class='id identifier rubyid_any_failed'>any_failed</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: task generated a non-boolean outcome</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='lparen'>(</span><span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span><span class='kw'>false</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_any_failed'>any_failed</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Task failed, not executing subsequent tasks</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_any_failed'>any_failed</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_report_failure'>report_failure</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_is_last'>is_last</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_count'>count</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>

    <span class='comment'># If all of the individual tasks succeeded, then the overall &#39;all&#39; task has succeeded
</span>    <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span><span class='rparen'>)</span>
    <span class='comment'>#logger.log(&quot;all task outcome: #{outcomes[-1]}&quot;)
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check-class_method">
  
    .<strong>check</strong>(*filenames, check_exe: false, subdir: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a task which will check to see if files in the <code>submission</code> directory exist. The returned task will push a true outcome if and only if all of the files exist.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filenames</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>filenames of which to check existence</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>check_exe</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if true, the returned task will also check that file(s) are executable (default false)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subdir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if set, file(s) are checked in specified subdirectory of <code>submission</code></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 282</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_filenames'>filenames</span><span class='comma'>,</span> <span class='label'>check_exe:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_checkdir'>checkdir</span> <span class='op'>=</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>submission</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submission/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subdir'>subdir</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_checks'>checks</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_filenames'>filenames</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_filename'>filename</span><span class='op'>|</span>
      <span class='id identifier rubyid_full_filename'>full_filename</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_checkdir'>checkdir</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Checking that </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'> exists</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_check_exe'>check_exe</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> and is executable</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_full_filename'>full_filename</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_check_exe'>check_exe</span> <span class='op'>||</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_executable?'>executable?</span><span class='lparen'>(</span><span class='id identifier rubyid_full_filename'>full_filename</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_checks'>checks</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'> doesn&#39;t exist</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_check_exe'>check_exe</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, or is not executable</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_checks'>checks</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_checks'>checks</span><span class='period'>.</span><span class='id identifier rubyid_all?'>all?</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_exe-class_method">
  
    .<strong>check_exe</strong>(*filenames, subdir: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check to see if files in the submission directory exist and are executable. Task will produce a true outcome IFF all of the files exist and are executable.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filenames</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>filenames of which to check existence/executability</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subdir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if set (non-nil), file(s) are checked in specified subdirectory of <code>submission</code></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


306
307
308</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 306</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_check_exe'>check_exe</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_filenames'>filenames</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_filenames'>filenames</span><span class='comma'>,</span> <span class='label'>check_exe:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="checkExe-class_method">
  
    .<strong>checkExe</strong>(*filenames, subdir: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'>
<p>Please use <span class='object_link'><a href="#check_exe-class_method" title="X.check_exe (method)">check_exe</a></span> instead</p>
</div></div>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


311
312
313</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 311</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_checkExe'>checkExe</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_filenames'>filenames</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_check_exe'>check_exe</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_filenames'>filenames</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="combine-class_method">
  
    .<strong>combine</strong>(*args)  &#x21d2; <tt>Array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Build an array consisting of all arguments as elements, with the exception that arguments that are arrays will have their elements added.  This is useful for building a large argument array out of an arbitrary combination of arrays and individual values.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the sequence of values to build</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>array containing the discovered non-array values in <code>args</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201
202
203
204
205
206
207
208
209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 199</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_combine'>combine</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="copy-class_method">
  
    .<strong>copy</strong>(*files, subdir: nil, report_command: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Copy one or more files from the <code>files</code> directory into the <code>submission</code> directory. This is useful for copying test scripts, secret inputs and expected outputs, and other data needed for test execution prior to executing tests.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>files</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>filenames to copy from <code>files</code> to <code>submission</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subdir</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if specified (non-nil), files are copied into this subdirectory of <code>submission</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_command</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if <code>true</code>, command is reported to student (defaults to <code>true</code>)</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 235</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_copy'>copy</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_files'>files</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>report_command:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: no file specified to copy</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='comment'># base case: copy a single file
</span>    <span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='id identifier rubyid_files'>files</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_destdir'>destdir</span> <span class='op'>=</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>submission</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submission/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subdir'>subdir</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Copying </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'> from files...</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>student_visible:</span> <span class='id identifier rubyid_report_command'>report_command</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='gvar'>$files</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_destdir'>destdir</span><span class='rparen'>)</span>
      <span class='comment'>#logger.log(&quot;cp result is #{rc}&quot;)
</span>      <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_rc'>rc</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># recursive case: copy multiple files
</span>    <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>=</span> <span class='id identifier rubyid_files'>files</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_filename'>filename</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_copy'>copy</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='comma'>,</span> <span class='label'>report_command:</span> <span class='id identifier rubyid_report_command'>report_command</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all'><span class='object_link'><a href="#all-class_method" title="X.all (method)">all</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasks'>tasks</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="copydir-class_method">
  
    .<strong>copydir</strong>(*dirnames, report_command: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Recursively copy one or more entire directories from the <code>files</code> directory into the <code>submission</code> directory</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>dirnames</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>directory names to recursively copy from <code>files</code> into <code>submission</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_command</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if <code>true</code>, command(s) are reported to student (defaults to <code>true</code>)</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 258</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_copydir'>copydir</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_dirnames'>dirnames</span><span class='comma'>,</span> <span class='label'>report_command:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: no directory specified to copy</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_dirnames'>dirnames</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_dirnames'>dirnames</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='comment'># base case: copy a single directory
</span>    <span class='id identifier rubyid_dirname'>dirname</span> <span class='op'>=</span> <span class='id identifier rubyid_dirnames'>dirnames</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Copying directory </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dirname'>dirname</span><span class='embexpr_end'>}</span><span class='tstring_content'> from files...</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>student_visible:</span> <span class='id identifier rubyid_report_command'>report_command</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_rc'>rc</span> <span class='op'>=</span> <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cp</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-r</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='gvar'>$files</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dirname'>dirname</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submission</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_rc'>rc</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># recursive case: copy multiple directories
</span>    <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>=</span> <span class='id identifier rubyid_dirnames'>dirnames</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_dirname'>dirname</span><span class='op'>|</span> <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_copydir'>copydir</span><span class='lparen'>(</span><span class='id identifier rubyid_dirname'>dirname</span><span class='comma'>,</span> <span class='label'>report_command:</span> <span class='id identifier rubyid_report_command'>report_command</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="" title="X (class)">X</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all'><span class='object_link'><a href="#all-class_method" title="X.all (method)">all</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasks'>tasks</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eval_pred-class_method">
  
    .<strong>eval_pred</strong>(pred, report_desc: true, report_outcome: true)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A task that evaluates a predicate and produces an outcome based on the result (true or false) of that predicate. This is useful for “synthetic” tests, i.e., ones whose outcomes aren&#39;t based by executing student code, but instead are evaluated by other criteria.  The “pred” parameter must have a “call” function which takes one parameter — the results map, which allows the predicate to know whether previous tests have passed or failed — and returns true or false. Suggestion: use the “pred” function to create the predicate, which will allow it to have a meaningful description that can be logged.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pred</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a predicate function (ideally, an instance of <span class='object_link'><a href="X/Pred.html" title="X::Pred (class)">Pred</a></span>)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_desc</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if true, evaluation and result of preddicate are publicly logged</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


480
481
482
483
484
485
486
487
488
489
490
491</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 480</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_eval_pred'>eval_pred</span><span class='lparen'>(</span><span class='id identifier rubyid_pred'>pred</span><span class='comma'>,</span> <span class='label'>report_desc:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>report_outcome:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_pred'>pred</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:desc</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_report_desc'>report_desc</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Checking predicate: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pred'>pred</span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_outcome'>outcome</span> <span class='op'>=</span> <span class='id identifier rubyid_pred'>pred</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_report_outcome'>report_outcome</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Predicate evaluated as </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_outcome'>outcome</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_outcome'>outcome</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute_tests-class_method">
  
    .<strong>execute_tests</strong>(rubric, plan)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Execute the tests and return a hash that can be converted into a results JSON file, using the correct schema for a Gradescope <code>results.json</code>. This the method which actually executes the test plan and produces the autograder results.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rubric</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the rubric, which is an array of rubric items (see the documentation for the <span class='object_link'><a href="Rubric.html" title="Rubric (class)">Rubric</a></span> class)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>plan</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a task to execute as the overall test plan: this will usually be created using the <span class='object_link'><a href="#all-class_method" title="X.all (method)">all</a></span> method, since prerequisite tasks will generally need to complete successfully before any actual testing of the student program can proceed</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash in Gradescope <code>results.json</code> format with the results of executing the autograder</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 722</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_execute_tests'>execute_tests</span><span class='lparen'>(</span><span class='id identifier rubyid_rubric'>rubric</span><span class='comma'>,</span> <span class='id identifier rubyid_plan'>plan</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_rubric'>rubric</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Rubric.html" title="Rubric (class)">Rubric</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Rubric.html#initialize-instance_method" title="Rubric#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_logger'>logger</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Logger.html" title="Logger (class)">Logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Logger.html#initialize-instance_method" title="Logger#initialize (method)">new</a></span></span>

  <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_logprivate'>logprivate</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Starting autograder (total points is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rubric'>rubric</span><span class='period'>.</span><span class='id identifier rubyid_get_total_points'>get_total_points</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># results is a map of testnames to earned scores
</span>  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='comment'># execute the plan
</span>  <span class='id identifier rubyid_outcomes'>outcomes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>

  <span class='comment'># prepare the report
</span>  <span class='id identifier rubyid_results_json'>results_json</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tests</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_rubric'>rubric</span><span class='period'>.</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tuple'>tuple</span><span class='op'>|</span>
    <span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_maxscore'>maxscore</span> <span class='op'>=</span> <span class='id identifier rubyid_tuple'>tuple</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span>
      <span class='comment'># no result was reported for this testname
</span>      <span class='comment'># this is *probably* because the associated test depended on a prerequisite task that failed
</span>      <span class='id identifier rubyid_results_json'>results_json</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tests</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_result_obj_for_missing_test'>result_obj_for_missing_test</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_outcome_pair'>outcome_pair</span> <span class='op'>=</span> <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='id identifier rubyid_testname'>testname</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_results_json'>results_json</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>tests</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_result_obj'>result_obj</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='comma'>,</span> <span class='id identifier rubyid_outcome_pair'>outcome_pair</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_results_json'>results_json</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expectfail-class_method">
  
    .<strong>expectfail</strong>(task)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a task which execute one specified task and expects it to fail. The “inverted” task succeeds if the original task fails, and vice versa.  This can be useful for testing error handling: i.e., a test sends an erroneous input to a program, and expects the program to report the error by exiting with a non-zero exit code, which is considered a “failed” execution by <span class='object_link'><a href="#run-class_method" title="X.run (method)">run</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>task</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the task to invert</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


653
654
655
656
657
658</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 653</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_expectfail'>expectfail</span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_b'>b</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="glob-class_method">
  
    .<strong>glob</strong>(pattern)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return list of files matching specified “file glob” pattern in <code>files</code> directory. “File glob” means “shell wildcard”, and the pattern is expanded by the Unix shell. This is not a task, it returns an array of the filenamess matching the pattern.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pattern</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a file glob pattern, e.g., <tt>*.c</tt> for all filenames ending in <code>.c</code></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>array of filenames matching the file glob pattern</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219
220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 217</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='id identifier rubyid_pattern'>pattern</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_popen'>popen</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cd </span><span class='embexpr_beg'>#{</span><span class='gvar'>$files</span><span class='embexpr_end'>}</span><span class='tstring_content'> &amp;&amp; sh -c &#39;ls -d </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pattern'>pattern</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_each_line'>each_line</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
      <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_rstrip!'>rstrip!</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inorder-class_method">
  
    .<strong>inorder</strong>(*tasks)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a task which executes a sequence of tasks and records their outcomes. Tasks can pass or fail completely independently: i.e., if an earlier task fails, the execution of subsequent tasks will still be attempted.</p>

<p>This is very useful for executing tests, where the failure of an earlier test should not prevent a later test from being attempted.</p>

<p>Pushes all of the outcomes generated by all of the executed tasks.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tasks</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the sequence of tasks</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


617
618
619
620
621
622
623</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 617</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_inorder'>inorder</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasks'>tasks</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_tasks'>tasks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
      <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make-class_method">
  
    .<strong>make</strong>(*makeargs, subdir: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create and return a task to run <code>make</code> in the <code>submission</code> directory (or a specified subdirectory).  Parameters passed to this function are passed as command-line arguments to <code>make</code> (when the task is executed).  With no arguments, the default target will be built.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>makeargs</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>argument strings to pass to <code>make</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subdir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if specified, make is run in this subdirectory of <code>submission</code></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 323</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_make'>make</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_makeargs'>makeargs</span><span class='comma'>,</span> <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># Determine where to run make
</span>    <span class='id identifier rubyid_cmddir'>cmddir</span> <span class='op'>=</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>submission</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submission/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subdir'>subdir</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># Make sure the directory actually exists
</span>    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='embexpr_end'>}</span><span class='tstring_content'> directory is missing?</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span><span class='lparen'>(</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_cmd'>cmd</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>make</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_makeargs'>makeargs</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Running command </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span><span class='lparen'>(</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Open3</span><span class='period'>.</span><span class='id identifier rubyid_capture3'>capture3</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='label'>stdin_data:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_success?'>success?</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successful make</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Make standard output</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='symbol'>:private</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Make standard error</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='comma'>,</span> <span class='symbol'>:private</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Make failed!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Make standard output</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='symbol'>:public</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Make standard error</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='comma'>,</span> <span class='symbol'>:public</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="nofail-class_method">
  
    .<strong>nofail</strong>(*tasks)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a task which executes all tasks in sequence and pushes their outcomes, but changes all of the outcomes to true, creating the illusion that all tests succeed even if they didn&#39;t.  So, the returned task works very much like one created by <span class='object_link'><a href="#inorder-class_method" title="X.inorder (method)">inorder</a></span>, but where all of the generated outcomes are guaranteed to be true.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tasks</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the sequence of tasks</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


633
634
635
636
637
638
639
640
641
642</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 633</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_nofail'>nofail</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasks'>tasks</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_task_outcomes'>task_outcomes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_tasks'>tasks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
      <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_task_outcomes'>task_outcomes</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="post_results-class_method">
  
    .<strong>post_results</strong>(results_json)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Write generated JSON results object to correct location to report autograder results to Gradescope</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


755
756
757
758
759
760</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 755</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_post_results'>post_results</span><span class='lparen'>(</span><span class='id identifier rubyid_results_json'>results_json</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mkdir -p results</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>results/results.json</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_outf'>outf</span><span class='op'>|</span>
    <span class='id identifier rubyid_outf'>outf</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_pretty_generate'>pretty_generate</span><span class='lparen'>(</span><span class='id identifier rubyid_results_json'>results_json</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pred-class_method">
  
    .<strong>pred</strong>(pred_func, desc)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a predicate from a lambda and a string with a textual description of the predicate being evaluated. The lambda should take one parameter, the results map. When creating an eval_pred task, using this function to create a predicate is preferred to just using a lambda because it allows the task to generate a meaningful student-visible log message describing what the predicate is evaluating.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>pred_func</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a predicate function (e..g, a lambda returning a boolean value)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>desc</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a description of the predicate, e.g. “determine if all unit tests passed”</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


462
463
464</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 462</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pred'>pred</span><span class='lparen'>(</span><span class='id identifier rubyid_pred_func'>pred_func</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="X/Pred.html" title="X::Pred (class)">Pred</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="X/Pred.html#initialize-instance_method" title="X::Pred#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_pred_func'>pred_func</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result_obj-class_method">
  
    .<strong>result_obj</strong>(testname, desc, maxscore, outcome_pair)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Internal method to create a result object for an executed test.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>testname</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the testname missing from the results map</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>desc</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the test description from the rubric</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>maxscore</span>
      
      
        <span class='type'>(<tt>Number</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the maximum score possible for the rubric item</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>outcome_pair</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a two element array: the first element is a 1 or 0 indicating whether the test passed or failed, and the second element is an array of public log messages to be reported to the student</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


699
700
701
702
703
704
705
706
707</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 699</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_result_obj'>result_obj</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='comma'>,</span> <span class='id identifier rubyid_outcome_pair'>outcome_pair</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_outcome_pair'>outcome_pair</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>max_score</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>output</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_outcome_pair'>outcome_pair</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>visibility</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__visibility_of'>_visibility_of</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="result_obj_for_missing_test-class_method">
  
    .<strong>result_obj_for_missing_test</strong>(testname, desc, maxscore)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Internal method to return a result object for a testname that is missing from the results map. Typically, a test with no result was not executed because a prerequisite step (in a task created by <span class='object_link'><a href="#all-class_method" title="X.all (method)">all</a></span>) failed, preventing the execution of a subsquent test. The result object will specify a score of 0.0 for the affected test.</p>

<p>Autograders should not need to call this method directly.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>testname</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the testname missing from the results map</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>desc</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the test description from the rubric</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>maxscore</span>
      
      
        <span class='type'>(<tt>Number</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the maximum score possible for the rubric item</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


680
681
682
683
684
685
686
687
688</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 680</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_result_obj_for_missing_test'>result_obj_for_missing_test</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_desc'>desc</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='float'>0.0</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>max_score</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_maxscore'>maxscore</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>output</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Test was not executed due to a failed prerequisite step</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>visibility</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid__visibility_of'>_visibility_of</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-class_method">
  
    .<strong>run</strong>(*cmd, timeout: DEFAULT_TIMEOUT, timeout_signal: nil, report_command: true, report_stdout: false, report_stderr: false, report_outcome: true, stdin_filename: nil, stdout_filename: nil, subdir: nil, env: {}, success_pred: DEFAULT_SUCCESS_PRED, rlimit_hash: {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create and return a task to run a command (program or script) in the <code>submission</code> directory (or a specified subdirectory).</p>

<p>Note that if <code>stdin_filename</code> is specified, its entire contents are read into memory, so you should avoid sending very large files that way.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the comand to run (first value is program, subsequent values are program arguments)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>timeout</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_TIMEOUT</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>timeout in seconds</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>timeout_signal</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>signal to send to the process if a timeout occurs, e.g., &#39;INT&#39; for SIGINT</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_command</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>report the executed command to student</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_stdout</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>report command stdout to student</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_stderr</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>report command stderr to student</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>report_outcome</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>report “Command failed!” if command fails (and report_command is true)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stdin_filename</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>name of file to send to command&#39;s stdin (if not specified, empty stdin is sent)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stdout_filename</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>name of file to write command&#39;s stdout to (in the submission directory, if not specified, no output file is written)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>subdir</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if specified, the command is run in this subdirectory of <code>submission</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>env</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if specified, hash with additional environment variables to set for subprocess</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>success_pred</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_SUCCESS_PRED</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>predicate to check subprocess success: must have a <code>call</code> method that takes process status object, standard output string, and standard error string as parameters, defaults to just checking status.success?</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rlimit_hash</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if specified, a hash of resource limit keys (e.g., <code>:rlimit_stack</code>) to their corresponding values, specifying resource limits for the subprocess</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 376</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run'>run</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span>
             <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#DEFAULT_TIMEOUT-constant" title="DEFAULT_TIMEOUT (constant)">DEFAULT_TIMEOUT</a></span></span><span class='comma'>,</span>
             <span class='label'>timeout_signal:</span> <span class='kw'>nil</span><span class='comma'>,</span>
             <span class='label'>report_command:</span> <span class='kw'>true</span><span class='comma'>,</span>
             <span class='label'>report_stdout:</span> <span class='kw'>false</span><span class='comma'>,</span>
             <span class='label'>report_stderr:</span> <span class='kw'>false</span><span class='comma'>,</span>
             <span class='label'>report_outcome:</span> <span class='kw'>true</span><span class='comma'>,</span>
             <span class='label'>stdin_filename:</span> <span class='kw'>nil</span><span class='comma'>,</span>
             <span class='label'>stdout_filename:</span> <span class='kw'>nil</span><span class='comma'>,</span>
             <span class='label'>subdir:</span> <span class='kw'>nil</span><span class='comma'>,</span>
             <span class='label'>env:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
             <span class='label'>success_pred:</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#DEFAULT_SUCCESS_PRED-constant" title="DEFAULT_SUCCESS_PRED (constant)">DEFAULT_SUCCESS_PRED</a></span></span><span class='comma'>,</span>
             <span class='label'>rlimit_hash:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># Determine where to run the command
</span>    <span class='id identifier rubyid_cmddir'>cmddir</span> <span class='op'>=</span> <span class='id identifier rubyid_subdir'>subdir</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>submission</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submission/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subdir'>subdir</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># Make sure the directory actually exists
</span>    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal error: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='embexpr_end'>}</span><span class='tstring_content'> directory is missing?</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span><span class='lparen'>(</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='rparen'>)</span>

    <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span><span class='lparen'>(</span><span class='id identifier rubyid_cmddir'>cmddir</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_stdin_data'>stdin_data</span> <span class='op'>=</span> <span class='id identifier rubyid_stdin_filename'>stdin_filename</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_stdin_filename'>stdin_filename</span><span class='comma'>,</span> <span class='label'>binmode:</span> <span class='kw'>true</span><span class='rparen'>)</span>

      <span class='comment'># Prepare the command to run (wrapping the requested command using timeout)
</span>      <span class='comment'>#cmd = [&#39;timeout&#39;, timeout.to_s ] + cmd
</span>      <span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeout</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--signal=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_timeout_signal'>timeout_signal</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_timeout_signal'>timeout_signal</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_timeout'>timeout</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span> <span class='op'>+=</span> <span class='id identifier rubyid_cmd'>cmd</span>

      <span class='id identifier rubyid_keyword_args'>keyword_args</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>stdin_data:</span> <span class='id identifier rubyid_stdin_data'>stdin_data</span><span class='comma'>,</span> <span class='label'>binmode:</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_rlimit_hash'>rlimit_hash</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid rlimit key </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rlimit_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_keyword_args'>keyword_args</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>

      <span class='comment'>#puts &quot;report_command=#{report_command}&quot;
</span>      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Running command: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>student_visible:</span> <span class='id identifier rubyid_report_command'>report_command</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Open3</span><span class='period'>.</span><span class='id identifier rubyid_capture3'>capture3</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_cmd_to_run'>cmd_to_run</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keyword_args'>keyword_args</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Standard output</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='id identifier rubyid_report_stdout'>report_stdout</span> <span class='op'>?</span> <span class='symbol'>:public</span> <span class='op'>:</span> <span class='symbol'>:private</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log_cmd_output'>log_cmd_output</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Standard error</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='comma'>,</span> <span class='id identifier rubyid_report_stderr'>report_stderr</span> <span class='op'>?</span> <span class='symbol'>:public</span> <span class='op'>:</span> <span class='symbol'>:private</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_stdout_filename'>stdout_filename</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_stdout_filename'>stdout_filename</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_outfh'>outfh</span><span class='op'>|</span>
          <span class='id identifier rubyid_outfh'>outfh</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_success_pred'>success_pred</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_stdout_str'>stdout_str</span><span class='comma'>,</span> <span class='id identifier rubyid_stderr_str'>stderr_str</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Command failed!</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>student_visible:</span> <span class='id identifier rubyid_report_command'>report_command</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_report_outcome'>report_outcome</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_outcomes'>outcomes</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test-class_method">
  
    .<strong>test</strong>(testname, task, judge: DEFAULT_JUDGE)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a task which executes a test by invoking the specified task and determining whether its outcome was successful, unsuccessful, or partially successful. The correctness of the test will be reported by being entered in the results map.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>testname</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the testname of the test to execute (which should have a corresponding rubric item!)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>task</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the task to execute: its success or failure determines whether the test passes or fails</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>judge</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>DEFAULT_JUDGE</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the judge function used to produce a “correctness score” in the range 0.0 (completely incorrect) to 1.0 (completely correct) from the outcomes array; the default judge assigns 0.0 or 1.0 based on the last boolean value in the outcomes array</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>the task object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 524</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_test'>test</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>judge:</span> <span class='const'><span class='object_link'><a href="top-level-namespace.html#DEFAULT_JUDGE-constant" title="DEFAULT_JUDGE (constant)">DEFAULT_JUDGE</a></span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Executing test: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rubric'>rubric</span><span class='period'>.</span><span class='id identifier rubyid_get_desc'>get_desc</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_rubric'>rubric</span><span class='rparen'>)</span>

    <span class='comment'># Use judge to determine correctness
</span>    <span class='id identifier rubyid_correctness'>correctness</span> <span class='op'>=</span> <span class='id identifier rubyid_judge'>judge</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_outcomes'>outcomes</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_correctness'>correctness</span> <span class='op'>&lt;</span> <span class='float'>0.0</span> <span class='op'>||</span> <span class='id identifier rubyid_correctness'>correctness</span> <span class='op'>&gt;</span> <span class='float'>1.0</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Judge produced incorrect correctness value </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_correctness'>correctness</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Report on success or failure
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_correctness'>correctness</span> <span class='op'>==</span> <span class='float'>1.0</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Test PASSED</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_correctness'>correctness</span> <span class='op'>==</span> <span class='float'>0.0</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Test FAILED</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Test resulted in partial credit</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Add to results and clear log messages
</span>    <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='id identifier rubyid_testname'>testname</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_correctness'>correctness</span><span class='comma'>,</span> <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_get_msgs'>get_msgs</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_passed-class_method">
  
    .<strong>test_passed</strong>(testname, results)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check whether a test passed. Requires that the results map is available, and contains a recorded result (0 for failure, 1 for success) for the named test. This can be called from within a predicate function, since the results map will be (at least partially) available by that time.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>testname</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the testname to inquire about</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>results</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the results map (map of testnames to evaluated numeric scores)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if the test passed, false if the test failed</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


503
504
505
506
507
508
509</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'autograder2.rb', line 503</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_test_passed'>test_passed</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_testname'>testname</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result_pair'>result_pair</span> <span class='op'>=</span> <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='id identifier rubyid_testname'>testname</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result_pair'>result_pair</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>&gt;=</span> <span class='float'>1.0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Jan 13 17:08:53 2023 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.0).
</div>

    </div>
  </body>
</html>